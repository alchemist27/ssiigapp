📄 PRD – 인테리어 매칭 플랫폼 (카페24 연동)
1. 프로젝트 개요

목표: 고객과 인테리어 업체를 온라인에서 매칭하고, 견적→계약→결제→정산까지 전 과정을 디지털화.

기반: 카페24 쇼핑몰 + 별도 Next.js 앱(Vercel 배포).

범위:

인테리어 공사 서비스 매칭 (프로젝트/견적/계약/마일스톤 기반, 커스텀 개발)

가구/홈데코, 3D콘텐츠 판매 (카페24 기본 상품/주문/배송 체계 활용)

2. 사용자 유형 & 권한

고객 (Client): 회원가입, 프로젝트 생성, 견적 비교, 계약/결제, 리뷰 작성

벤더 (Vendor)

 1) 인테리어 업체: 프로젝트 열람, 견적 제출, 계약/마일스톤 진행, 정산 확인

 2) 가구/홈데코 판매사: 카페24 공급사로 상품/주문/배송 관리

 3) 3D 콘텐츠 판매사:  카페24 공급사로 상품/주문/배송 관리

운영자/어드민 (Ops Admin): 입점 심사, 프로젝트/분쟁 관리, 환불 승인, 수수료율 설정

3. 주요 기능
3.1 고객 사이드

프로젝트 생성 (도면 업로드, 예산, 지역, 스타일 등 입력)

벤더 견적 비교 (가격/조건/기간)

계약 체결 (전자서명) 및 결제 (카페24 비공개 SKU)

진행현황/마일스톤(진행정도 %로 표현) 확인, 변경합의 추가 결제

최종 리뷰 작성

3.2 벤더 사이드

프로필/지역/전문분야 등록

프로젝트 열람, Q&A 채팅

견적 제출 (템플릿 기반: 범위, 예외, 금액, 기간 등)

공사 상세내역 템플릿 구현

계약/마일스톤 진행 관리

정산 내역 확인 (공사: 우리 앱 집계, 상품/디지털: 카페24 정산)

3.3 운영자/마스터

벤더 입점/서류 심사

분쟁/환불 처리

수수료율·정산 주기 설정

감사로그, 리스크 모니터링

카페24 API/PG 연동 관리

4. 카페24 연동 방식

결제 처리:

공사: 견적 금액으로 계약 시 → Admin API로 비공개 SKU 생성(price=견적금액, display=F) → 주문 생성 → 고객 결제

가구/홈데코, 3D: 카페24 상품/주문 체계 그대로 사용

Webhook: 주문완료/환불 이벤트 수신 → 우리 앱의 프로젝트/마일스톤 상태 동기화

회원 매핑: 카페24 member_id ↔ 우리 앱 uid 매핑

SSO: 스킨에 삽입한 로더에서 {$member_id} 전달 → 우리 앱에서 JWT 발급

5. 데이터 모델 (Firestore 예시)

users/{uid}: role, memberId, profile, vendorId

vendors/{vendorId}: type(공사/상품/3D), areas[], docs[], status

projects/{projectId}: ownerUid, budget, region, style[], files[], status

quotes/{quoteId}: projectId, vendorId, amount, terms, validity

contracts/{id}: projectId, vendorId, milestones[], signedAt

milestones/{id}: contractId, name, amount, dueAt, status, orderNo

orders/{id}: 카페24 orderNo, projectId, vendorId, milestoneId, status

downloads/{id}: orderNo, fileRef, expiresAt, license

commissions/{id}: orderNo, feeRate, gross, net

payouts/{id}: vendorId, period, total, status

6. 기술 스택

Frontend: Next.js (Vercel), Tailwind, shadcn/ui

Backend(API): Next.js API Routes, Firebase Functions(보조)

DB/Storage: Firebase Firestore + Storage

Auth/SSO: Firebase Auth + 카페24 member_id 기반 JWT

3rd Party: 카페24 Admin API/Webhook, PG, 전자서명 API, 알림톡/메일

7. UI/UX 플로우 (요약)

고객: 로그인 → 프로젝트 등록 → 견적 확인 → 계약/결제 → 진행현황 → 리뷰

벤더: 로그인 → 프로젝트 열람 → 견적 제출 → 계약/진행 관리 → 정산 확인

운영자: 벤더 심사 → 프로젝트/분쟁 관리 → 정산 집계 → 수수료 정책 관리



8. 개발 순서:

1) 개발 환경 세팅: vercel, firebase, github 등
2) 고객 진입 환경: 
2-1) 카페24 랜딩페이지 진입
2-2) 기존 타고객 등록 프로젝트 그리드 확인(상세내역확인불가)
2-3) 프로젝트 생성 --> 카페24 회원가입/로그인 --> 프로젝트 생성 UI 진입 (우리가 여기서 별도로 만들 앱) --> 프로젝트 등록시 DB저장 --> 인테리어 공사업체, 관리자에 알림 전송 --> 견적서 대기중 상태 --> 공사업체가 견적서 제출시 상태 변경. 공사업체가 제출한 견적 내역서 열람가능. 계약 체결시 해당금액으로 카페24 비공개 상품 생성 및 결제 요청
2-4) 카페24 기반으로 공급사가 등록한 실물상품/3D콘텐츠 상품 노출 --> 카페24 쇼핑몰에서 모두 처리


제안 개발 순서 (병행 트랙 + 크리티컬 패스)
0) 공통 설계 (D–1)

도메인 모델/ERD 확정: users, vendors, projects, quotes, contracts, milestones, orders, commissions.

권한 매트릭스: Customer/Vendor Admin/Vendor Staff/Ops/Master.

상태 다이어그램: 프로젝트/견적/마일스톤/주문(Webhook 연동 상태).

이걸 먼저 확정해야 이후 프론트·백엔드가 병렬로 달릴 수 있어요.

1) 기반/인프라 (크리티컬 패스)

환경 세팅: Vercel, Firebase(Auth/Firestore/Storage), GitHub, 브랜치 전략, .env 관리.

카페24 연동 부트스트랩

Admin API 자격/리프레시, Webhook 엔드포인트 골격(모의 페이로드 저장만).

임베드 로더(카페24 스킨에 삽입할 얇은 스니펫) + SSO 교환(Nonce→JWT) 기본형.

여기까지 되면, 고객/벤더 화면은 페이크 데이터로도 개발 시작 가능.

2) 고객 트랙 (A) – MVP 기능

A1. 프로젝트 브라우즈(비로그인)

카페24 랜딩 → “타 고객 등록 프로젝트 그리드” 목록만 표시(상세 비공개).

Firestore에서 projects.public_meta만 읽어오는 공개용 API.

A2. 프로젝트 생성(로그인/SSO)

카페24 로그인 연결 → 우리 앱 JWT.

프로젝트 폼, 파일 업로드(Storage, 서명URL), DB 저장.

상태: PENDING_QUOTES.

A3. 알림 발송

조건(지역/태그)에 맞는 벤더에게 알림(이메일/알림톡).

알림 템플릿/재시도 큐 마련.

A4. 견적 열람/선택

고객이 받은 견적 리스트/비교(가격/기간/조건/예외).

선택 시 SELECTED_QUOTE → 계약 초안 생성 트리거.

A5. 계약/결제 준비(고객화면)

계약서 요약 보기(전자서명 화면은 벤더 트랙 C와 연동).

“결제하기” 버튼 → 결제 대기(주문URL/바로구매).

A 트랙은 B(벤더 트랙)에서 “견적 제출, 계약 확정”이 구현되어야 완성 루프가 닫힙니다.

3) 벤더 트랙 (B) – MVP 기능

B1. 벤더 온보딩

벤더 프로필(지역·전문·서류) 등록, 승인 플로우(Ops가 승인).

벤더 대시보드: “열람 가능 프로젝트” 목록.

B2. 프로젝트 열람 & Q&A

권한 기반 열람(파일 워터마크·다운로드 제어), Q&A 쓰레드.

B3. 견적 제출

표준 템플릿(범위/예외/단가×수량/기간/보증).

제출/수정(버전이력), 유효기간/첨부.

B4. 계약 초안 생성(선택된 벤더)

고객이 벤더 선택 → 계약서 초안 자동 생성(견적 복제).

전자서명 초안 발행(서명 프로바이더 연동은 초기엔 간이 동의 체크 + PDF 생성으로 시작 가능).

B 트랙이 살아야 A 트랙의 “견적 보기→선택→계약”이 실제 데이터로 연결됩니다.

4) 결제/주문/웹훅 트랙 (C) – 크리티컬 패스

C1. 비공개 SKU 생성 API

계약 확정/마일스톤 생성 시 → Admin API로 1회용 비공개 상품 생성(price=확정금액, display=F).

옵션/메모에 projectId/vendorId/milestoneId 저장.

C2. 체크아웃/주문 생성 흐름

고객 버튼 → 장바구니/바로구매 링크 생성 반환.

주문 전/후 로깅.

C3. Webhook 처리기(결제완료/취소/환불)

주문번호 ↔ milestone 매핑, 상태천이 PAID/REFUNDED/FAILED.

멱등성 키, 재시도, 감사로그.

C4. 정산 집계(초기 수동)

commissions/payouts 집계 스냅샷 생성(월 2회 기준 CSV/PDF).

이 트랙이 완료되어야 “계약=돈 흐름”이 닫혀 E2E 시나리오가 완성됩니다.

5) 운영/어드민 트랙 (D)

D1. Ops 콘솔 최소기능

벤더 심사 승인/반려, 프로젝트 강제 상태 변경, 분쟁 플래그.

로그 뷰어(Webhook 이벤트, 상태변경).

D2. 설정

수수료율 테이블, 알림 템플릿, 파일 보존 기간.

6) 카탈로그(가구/3D) 트랙 (E) – 읽기 통합

E1. 가구/홈데코·3D 상품 노출(읽기 전용)

카페24 카테고리/상품 목록을 우리 앱에서 카드형으로 노출(넘어가면 쇼핑몰에서 처리).

추후 3D 콘텐츠는 결제후 다운로드 토큰(후순위).

7) 안정화/보안 (전 구간 공통)

파일 접근: 프로젝트 스코프 서명URL, 만료/리퍼러 검사.

감사로그: 상태변경/다운로드/권한변경/결제 이벤트 전부.

레이스/멱등성: Webhook/결제 수신 중복 방지 키.

장애대응: 알림 실패 재시도, 결제 원복 시나리오.

스프린트 제안 (8–10주 MVP)

Sprint 1

0,1 완료(인프라/SSO/임베드).

A1(공개 그리드), A2(프로젝트 생성 기본), B1(벤더 온보딩 기본).

Sprint 2

B2(열람/Q&A), B3(견적 제출), A4(견적 비교/선택).

C1(비공개 SKU 생성 골격), D1(Ops 최소).

Sprint 3

B4(계약 초안/PDF), A5(결제 진입), C2(체크아웃), C3(Webhook 멱등).

정산 집계 초안(C4).

Sprint 4

알림 시나리오 고도화, 파일 권한/워터마크, 에러 핸들링/감사로그.

E1(가구/3D 노출), QA/UAT/운영 플랜.

왜 이 순서가 좋은가

고객 A 트랙은 초반부터 “보이는 것”을 만들고,

벤더 B 트랙이 중반에 붙으면서 실제 견적 루프가 생기고,

결제 C 트랙이 닫히면 E2E 가치흐름 완성,

이후 운영 D, 카탈로그 E로 확장합니다.


